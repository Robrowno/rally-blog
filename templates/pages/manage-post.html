{% extends 'base.html' %} {% load static %} {% block content %} {% load crispy_forms_tags %}
{% load cloudinary %}

{% if user.is_superuser %}

<div class="container-fluid mt-3">
    <div class="row">
        <div class="col-lg-3">
            <button class="btn btn-primary"><a href="{% url 'manage' %}">Go Back</a></button>
        </div>

        <h1 class="text-center">Edit Post</h1>
    </div>

    <p id="form_validation_message"></p>
    <div class="container login-page">
        <div class="row">
            <div class="col-md-8 mt-3 offset-md-2">
                <h1>Edit Post</h1>
            </div>
        </div>
        <div class="row">
            <div class="col-md-8 mt-3 offset-md-2">
                <form enctype="multipart/form-data" method="POST" class="post" id="add_post_form">
                    {% csrf_token %}
                    <div class="col {{ field_class }}">
                        {{ form|crispy }}
                    </div>
                    <div class="col-md-12 mb-3 mt-2">
                        <button class="btn btn-primary" type="submit" value="submit">Update Post</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


</div>
<script>
    /* This validates the add_post form */
const post_form = document.getElementById('add_post_form');
const title = document.getElementById('id_title').value;
const messageBlock = document.getElementById('form_validation_message');

function errorMessage(message){
    e.preventDefault();
    const messageText = document.createTextNode(message);
    messageBlock.appendChild(messageText);
}

post_form.addEventListener('submit', (e) => {
    if(document.getElementById("featured_image").value === '') {
        e.preventDefault();
        alert('Please provide a image.');
        errorMessage('Please provide a image.');
    }

    // if (title.length < 6) {
    //     alert('Your title is too short');
    //     errorMessage('Your title is too short');
    //     e.preventDefault();
    // }
});
</script>
{% else %}

<h1 class="text-center mt-5"> Sorry, you can't view this page! Click <a class="link-primary text-decoration-underline"
        href="/">Here</a> to go back!</h1>

{% endif %}




{% endblock %}